{
  "nextId": 100,
  "objects": {
    "0": {
      "id": 0,
      "parent_id": null,
      "name": "System Object",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "failed_match",
          "value": {
            "_mooObject": -3
          }
        },
        {
          "key": "ambiguous_match",
          "value": {
            "_mooObject": -2
          }
        },
        {
          "key": "nothing",
          "value": {
            "_mooObject": -1
          }
        },
        {
          "key": "sys",
          "value": {
            "_mooObject": 0
          }
        },
        {
          "key": "root",
          "value": {
            "_mooObject": 1
          }
        },
        {
          "key": "player",
          "value": {
            "_mooObject": 2
          }
        },
        {
          "key": "room",
          "value": {
            "_mooObject": 4
          }
        },
        {
          "key": "thing",
          "value": {
            "_mooObject": 5
          }
        },
        {
          "key": "exit",
          "value": {
            "_mooObject": 8
          }
        },
        {
          "key": "tunneler",
          "value": {
            "_mooObject": 14
          }
        },
        {
          "key": "wizard",
          "value": {
            "_mooObject": 3
          }
        },
        {
          "key": "util",
          "value": {
            "_mooObject": 21
          }
        }
      ],
      "verbs": [
        {
          "name": "server_started",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "# TODO"
        },
        {
          "name": "player_created",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "player.parent = $player\n$sys.player_connected()"
        },
        {
          "name": "player_connected",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "player.location = $(6)\nplayer.tell \"{blue bold|Welcome, #{player.name}!}\"\nplayer.location.player_connected?()"
        },
        {
          "name": "player_disconnected",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "player.location.player_disconnected?()\nplayer.location = null"
        }
      ],
      "crontab": []
    },
    "1": {
      "id": 1,
      "parent_id": null,
      "name": "Root Class",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [],
      "verbs": [
        {
          "name": "tell",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "[msg] = args\n\nif @player\n  @send msg"
        }
      ],
      "crontab": []
    },
    "2": {
      "id": 2,
      "parent_id": 1,
      "name": "Player Class",
      "aliases": [
        "player"
      ],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "color",
          "value": "gray"
        }
      ],
      "verbs": [
        {
          "name": "i*nventory",
          "hidden": false,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "names = @contents.map (i) -> i.name\nnames.unshift \"You are carrying:\"\n@tell names.join \"\\n\""
        }
      ],
      "crontab": []
    },
    "3": {
      "id": 3,
      "parent_id": 2,
      "name": "Gandalf",
      "aliases": [],
      "location_id": null,
      "contents_ids": [
        14
      ],
      "player": true,
      "programmer": true,
      "properties": [
        {
          "key": "color",
          "value": "magenta"
        },
        {
          "key": "bearings",
          "value": [
            "north"
          ]
        }
      ],
      "verbs": [],
      "crontab": [],
      "username": "root",
      "password": "a075d17f3d453073853f813838c15b8023b8c487038436354fe599c3942e1f95"
    },
    "4": {
      "id": 4,
      "parent_id": 1,
      "name": "Room Class",
      "aliases": [
        "room"
      ],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "description",
          "value": "A generic room."
        },
        {
          "key": "exits",
          "value": {}
        }
      ],
      "verbs": [
        {
          "name": "l*ook",
          "hidden": false,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "output = [\"{yellow bold|#{player.location.name}}\"]\noutput.push player.location.description\nthings = (thing for thing in player.location.contents when thing != player)\nif things.length > 0\n  output.push '{cyan|You see here:}'\n  for thing in things\n    output.push \"{cyan|#{thing.name}}\"\n\nplayer.tell output.join '\\n'"
        },
        {
          "name": "say",
          "hidden": false,
          "dobjarg": "any",
          "preparg": "any",
          "iobjarg": "any",
          "code": "msg = \"\\\"{white|#{argstr.trim()}}\\\"\"\nplayer.tell \"{gray|You say #{msg}}\"\nplayer.location.announce \"{gray|{#{player.color}|#{player.name}} says #{msg}}\""
        },
        {
          "name": "huh",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "handleFailedOrAmbiguous = ->\n  if dobj == $ambiguous_match\n    objects = $util.orjoin match(dobjstr).map (o) -> o.name\n    player.tell \"{gray|I couldn't tell if you meant #{objects}.}\"\n  else if iobj == $ambiguous_match\n    objects = $util.orjoin match(iobjstr).map (o) -> o.name\n    player.tell \"{gray|I couldn't tell if you meant #{objects}.}\"\n  else if dobj == $failed_match\n    player.tell \"{gray|I don't see any #{dobjstr} here.}\"\n  else if iobj == $failed_match\n    player.tell \"{gray|I don't see any #{iobjstr} here.}\"\n  else\n    player.tell \"{gray|I didn't understand that.}\"\n\nmatches = (direction for direction of player.location.exits).filter (direction) ->\n  direction.indexOf(verb) == 0\n\nswitch matches.length\n  when 0\n    handleFailedOrAmbiguous()\n  when 1\n    player.location.exits[matches[0]].invoke()\n  else\n    directions = $util.orjoin matches\n    player.tell \"Did you mean #{directions}?\""
        },
        {
          "name": "player_connected",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "player.location.look()\nplayer.location.announce \"#{player.name} pops into existence.\""
        },
        {
          "name": "player_disconnected",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "player.location.announce \"#{player.name} fades away.\""
        },
        {
          "name": "go",
          "hidden": false,
          "dobjarg": "any",
          "preparg": "none",
          "iobjarg": "none",
          "code": "matched_exits = (name for name, exit of player.location.exits when argstr == name)\nswitch matched_exits.length\n  when 0\n    player.tell \"You can't go #{argstr}.\"\n  when 1\n    portal = player.location.exits[matched_exits[0]]\n    retreats = (retreat for retreat, exit of portal.destination.exits when exit.destination == player.location)\n    switch retreats.length\n      when 0\n        player.bearings = []\n      else\n        player.bearings = retreats\n    portal.invoke()\n  else\n    directions = $util.orjoin matched_exits\n    player.tell \"Did you mean #{directions}?\""
        },
        {
          "name": "player_left",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "[direction] = args\nplayer.tell \"You go #{direction}.\"\nplayer.location.announce \"#{player.name} goes #{direction}.\""
        },
        {
          "name": "player_arrived",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "player.location.look()\nplayer.location.announce \"#{player.name} arrives.\""
        },
        {
          "name": "emote",
          "hidden": false,
          "dobjarg": "any",
          "preparg": "any",
          "iobjarg": "any",
          "code": "msg = ['{bold magenta|*}', player.name, argstr.trim()].join ' '\nplayer.tell msg\nplayer.location.announce msg"
        },
        {
          "name": "announce",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "[msg] = args\n\nfor obj in @contents\n  if obj != player\n    obj.tell?(msg)"
        },
        {
          "name": "help",
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "player.tell \"Basic commands: look, say [anything], examine [object], get [object], drop [object], inventory, help\""
        }
      ],
      "crontab": []
    },
    "5": {
      "id": 5,
      "parent_id": 1,
      "name": "Thing Class",
      "aliases": [
        "item"
      ],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "description",
          "value": "A generic item."
        }
      ],
      "verbs": [
        {
          "name": "ex*amine",
          "hidden": false,
          "dobjarg": "this",
          "preparg": "none",
          "iobjarg": "none",
          "code": "msg = []\nmsg.push \"#{@name}:\"\nmsg.push @description\navailable_actions = $util.orjoin (key for key, value of @ when value.verb and not value.hidden)\nmsg.push \"Available actions: #{available_actions}\"\nplayer.tell msg.join '\\n'"
        },
        {
          "name": "g*et t*ake gr*ab",
          "dobjarg": "this",
          "preparg": "none",
          "iobjarg": "none",
          "code": "if @location == player\n  player.tell \"You're already holding the #{@name}.\"\nelse\n  @location = player\n  player.tell \"You pick up the #{@name}.\"\n  player.location.announce \"#{player.name} picks up the #{@name}.\""
        },
        {
          "name": "d*rop",
          "dobjarg": "this",
          "preparg": "none",
          "iobjarg": "none",
          "code": "if @location == player\n  @location = player.location\n  player.tell \"You drop the #{@name}.\"\n  player.location.announce \"#{player.name} drops the #{@name}.\"\nelse\n  player.tell \"You're not holding the #{@name}.\""
        }
      ],
      "crontab": []
    },
    "6": {
      "id": 6,
      "parent_id": 4,
      "name": "A forest clearing",
      "aliases": [
        "clearing"
      ],
      "location_id": null,
      "contents_ids": [
        34,
        28,
        26,
        7
      ],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "description",
          "value": "The forest thins out here a bit. To the north you can see the entrance to a cave through the bushes. There is also a trap door barely visible in the grass."
        },
        {
          "key": "exits",
          "value": {
            "north": {
              "_mooObject": 9
            },
            "down": {
              "_mooObject": 16
            },
            "nowhere": {
              "_mooObject": 19
            }
          }
        },
        {
          "key": "description",
          "value": "The forest thins out here a bit. To the north you can see the entrance to a cave through the bushes."
        }
      ],
      "verbs": [],
      "crontab": []
    },
    "7": {
      "id": 7,
      "parent_id": 5,
      "name": "wooden sword",
      "aliases": [
        "sword"
      ],
      "location_id": 6,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "description",
          "value": "A simple wooden sword."
        }
      ],
      "verbs": [
        {
          "name": "swing",
          "dobjarg": "this",
          "preparg": "none",
          "iobjarg": "none",
          "code": "if @location == player\n  player.tell \"You swing the wooden sword around. You look a bit silly.\"\n  player.location.announce \"#{player.name} swings a wooden sword around.\"\nelse\n  player.tell \"You're not holding the sword.\""
        }
      ],
      "crontab": []
    },
    "8": {
      "id": 8,
      "parent_id": 1,
      "name": "Exit Class",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [],
      "verbs": [
        {
          "name": "invoke",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "direction = @name\ndestination = @destination\n\nplayer.location.player_left?(direction)\n\nplayer.location = destination\n\ndestination.player_arrived?()"
        }
      ],
      "crontab": []
    },
    "9": {
      "id": 9,
      "parent_id": 8,
      "name": "north",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "destination",
          "value": {
            "_mooObject": 10
          }
        }
      ],
      "verbs": [],
      "crontab": []
    },
    "10": {
      "id": 10,
      "parent_id": 4,
      "name": "A Cave",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "description",
          "value": "This is a dark and slightly damp cave. You can barely see anything except the light coming from the opening to the south."
        },
        {
          "key": "exits",
          "value": {
            "south": {
              "_mooObject": 11
            }
          }
        }
      ],
      "verbs": [],
      "crontab": []
    },
    "11": {
      "id": 11,
      "parent_id": 8,
      "name": "south",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "destination",
          "value": {
            "_mooObject": 6
          }
        }
      ],
      "verbs": [],
      "crontab": []
    },
    "14": {
      "id": 14,
      "parent_id": 5,
      "name": "tunneler",
      "aliases": [],
      "location_id": 3,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "description",
          "value": "A device used for tunneling into new areas. Only usable by programmers or builders. To use it, type 'go <direction> with tunneler'."
        }
      ],
      "verbs": [
        {
          "name": "go",
          "hidden": false,
          "dobjarg": "any",
          "preparg": "with/using",
          "iobjarg": "this",
          "code": "if not (player.programmer or player.builder)\n  throw new Error \"You're not allowed to use the tunneler\"\n\ndirection = dobjstr\nif not direction\n  throw new Error \"Invalid direction\"\n\nif player.location.exits[direction]?\n  throw new Error \"That direction already exists!\"\n\nplayer.tell \"Going #{direction} #{prepstr} the tunneler!\"\n\nconnectTo = (room) ->\n  exit = $exit.create direction\n  exit.destination = room\n  \n  player.location.exits[direction] = exit\n\n  exit.invoke()\n\nplayer.input \"Connect to an {magenta|existing} room or a {magenta|new} room?\", (response) ->\n  switch response\n    when 'existing'\n      player.input \"ID of existing room:\", (id) ->\n        if (room = $(id)) # TODO check if room is descendant of room class?\n          connectTo room\n        else\n          throw new Error \"Couldn't find room with id '#{id}'\"\n    when 'new'\n      player.input \"Give me a name for the new room:\", (name) ->\n        player.input \"Descripe the new room:\", (description) ->\n          newRoom = $room.create name\n          newRoom.description = description\n          connectTo newRoom\n    else\n      player.tell \"{red|Unknown response. Was expecting either 'existing' or 'new'}\""
        }
      ],
      "crontab": []
    },
    "15": {
      "id": 15,
      "parent_id": 4,
      "name": "Dungeon cell",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "description",
          "value": "A small cell in what appears to be a dungeon. There are 3 stone walls and metal bars to the west. The bars have a door built into them. A ladder on the north wall goes up to a trap door."
        },
        {
          "key": "exits",
          "value": {
            "west": {
              "_mooObject": 25
            },
            "up": {
              "_mooObject": 17
            }
          }
        }
      ],
      "verbs": [],
      "crontab": []
    },
    "16": {
      "id": 16,
      "parent_id": 8,
      "name": "down",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "destination",
          "value": {
            "_mooObject": 15
          }
        }
      ],
      "verbs": [],
      "crontab": []
    },
    "17": {
      "id": 17,
      "parent_id": 8,
      "name": "up",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "destination",
          "value": {
            "_mooObject": 6
          }
        }
      ],
      "verbs": [],
      "crontab": []
    },
    "18": {
      "id": 18,
      "parent_id": 4,
      "name": "Nowhere",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "description",
          "value": "You are nowhere. For real. Maybe you should go somewhere?"
        },
        {
          "key": "exits",
          "value": {
            "somewhere": {
              "_mooObject": 20
            }
          }
        }
      ],
      "verbs": [],
      "crontab": []
    },
    "19": {
      "id": 19,
      "parent_id": 8,
      "name": "nowhere",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "destination",
          "value": {
            "_mooObject": 18
          }
        }
      ],
      "verbs": [],
      "crontab": []
    },
    "20": {
      "id": 20,
      "parent_id": 8,
      "name": "somewhere",
      "aliases": [
        "elsewhere"
      ],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "destination",
          "value": {
            "_mooObject": 6
          }
        }
      ],
      "verbs": [],
      "crontab": []
    },
    "21": {
      "id": 21,
      "parent_id": 1,
      "name": "Utility Verbs",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "hidden_verbs",
          "value": [
            "orjoin"
          ]
        }
      ],
      "verbs": [
        {
          "name": "orjoin",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "a = args[0]\na[0..a.length-2].join(', ') + ' or ' + a[a.length-1]"
        }
      ],
      "crontab": []
    },
    "25": {
      "id": 25,
      "parent_id": 8,
      "name": "west",
      "aliases": [],
      "location_id": null,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [],
      "verbs": [
        {
          "name": "invoke",
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "player.tell 'The door is locked.'"
        }
      ],
      "crontab": []
    },
    "26": {
      "id": 26,
      "parent_id": 5,
      "name": "Larry the bird",
      "aliases": [
        "larry",
        "bird"
      ],
      "location_id": 6,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "description",
          "value": "A small blue bird conversant in the conversations of the hottest social media superstars. Ask him about someone!"
        }
      ],
      "verbs": [
        {
          "name": "ask",
          "hidden": false,
          "dobjarg": "this",
          "preparg": "for/about",
          "iobjarg": "any",
          "code": "browser.get 'api.twitter.com', \"/1/statuses/user_timeline/#{iobjstr}.json?count=1&include_rts=0\", (response) ->\n  \n  player.location.announce \"{gray|#{player.name} asks Larry about #{iobjstr}}\"\n  \n  tweets = JSON.parse response\n  if tweets?[0]?.text?\n    tweet = tweets[0].text\n    say = \"I heard {blue bold|@#{iobjstr}} recently saying: \\\"#{tweet}\\\"\"\n  else\n    say = \"I don't know about anyone called #{iobjstr}\"\n    \n  msg = \"{gray|Larry says \\\"{white|#{say}}\\\"}\"\n  player.tell msg\n  player.location.announce msg"
        }
      ],
      "crontab": []
    },
    "28": {
      "id": 28,
      "parent_id": 5,
      "name": "iron sword",
      "aliases": [
        "sword"
      ],
      "location_id": 6,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "description",
          "value": "A dull iron sword."
        }
      ],
      "verbs": [],
      "crontab": []
    },
    "34": {
      "id": 34,
      "parent_id": 5,
      "name": "blinker",
      "aliases": [],
      "location_id": 6,
      "contents_ids": [],
      "player": false,
      "programmer": false,
      "properties": [
        {
          "key": "description",
          "value": "A thing that blinks"
        }
      ],
      "verbs": [
        {
          "name": "blink",
          "hidden": true,
          "dobjarg": "none",
          "preparg": "none",
          "iobjarg": "none",
          "code": "@location.announce? \"The blinker flashes {bold|bright white light} in all directions! You are momentarily blinded.\""
        }
      ],
      "crontab": [
        {
          "spec": "*/5 * * * *",
          "verb": "blink",
          "enabled": true
        }
      ]
    }
  }
}